#!/usr/bin/env bash
set -e

while echo -n "Â·" && sleep 1; do :; done &
echoPid=$!
trap "kill -- -$$ >/dev/null || kill $echoPid" EXIT

while true; do
  echo -n "master switchover: "
  docker exec jobscheduler-master switch-over || true
  sleep $((2 ** (RANDOM / 8000)))
  echo -n "backup-master switchover: "
  docker exec jobscheduler-backup-master switch-over || true
  sleep $((2 ** (RANDOM / 8000)))
done

wait
